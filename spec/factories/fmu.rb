FactoryBot.define do
  factory :fmu do
    sequence(:name) { |n| "FMU#{n}" }
    forest_type { 1 }

    after(:build) do |random_fmu|
      random_fmu.country ||= FactoryBot.create(:country)
    end

    trait :geojson do
      geojson {
        {
          "type": "Feature",
          "geometry": {
            "type": "MultiPolygon",
            "coordinates": [[[[16.823474, -3.23563],
                              [16.848206, -3.23662],
                              [16.868121, -3.233131],
                              [16.88805, -3.237237],
                              [16.913122, -3.236499],
                              [16.929253, -3.2306],
                              [16.947449, -3.226768],
                              [16.954685, -3.239181],
                              [16.957112, -3.250569],
                              [16.949221, -3.255072],
                              [16.935836, -3.260621],
                              [16.915252, -3.273434],
                              [16.897415, -3.285896],
                              [16.888514, -3.301448],
                              [16.886487, -3.319749],
                              [16.879656, -3.34013],
                              [16.880367, -3.352557],
                              [16.891385, -3.366344],
                              [16.903773, -3.377022],
                              [16.911007, -3.379732],
                              [16.911111, -3.379771],
                              [16.911174, -3.379795],
                              [16.911205, -3.379806],
                              [16.917523, -3.382173],
                              [16.932291, -3.380418],
                              [16.947064, -3.381424],
                              [16.94639, -3.387984],
                              [16.949166, -3.401787],
                              [16.9509, -3.410068],
                              [16.96877, -3.413829],
                              [16.982533, -3.424502],
                              [16.995955, -3.436901],
                              [16.984639, -3.446246],
                              [16.965056, -3.445596],
                              [16.948566, -3.444939],
                              [16.939286, -3.442887],
                              [16.928636, -3.442564],
                              [16.92282, -3.454313],
                              [16.90911, -3.470221],
                              [16.898811, -3.473694],
                              [16.887126, -3.471991],
                              [16.883341, -3.468892],
                              [16.878162, -3.455783],
                              [16.873691, -3.445271],
                              [16.872295, -3.441986],
                              [16.86925, -3.438612],
                              [16.862655, -3.431303],
                              [16.862692, -3.42933],
                              [16.862741, -3.426714],
                              [16.862801, -3.423539],
                              [16.862871, -3.41982],
                              [16.862966, -3.414731],
                              [16.864435, -3.410167],
                              [16.867747, -3.399877],
                              [16.857443, -3.400588],
                              [16.845077, -3.401647],
                              [16.826189, -3.40479],
                              [16.803875, -3.413809],
                              [16.793551, -3.404161],
                              [16.782537, -3.392789],
                              [16.770832, -3.379346],
                              [16.7605, -3.364864],
                              [16.759106, -3.353819],
                              [16.759349, -3.353146],
                              [16.764233, -3.339654],
                              [16.770389, -3.324107],
                              [16.772074, -3.305806],
                              [16.772736, -3.29165],
                              [16.771306, -3.290271],
                              [16.763445, -3.28269],
                              [16.758004, -3.277493],
                              [16.74865, -3.268561],
                              [16.751007, -3.260044],
                              [16.753429, -3.25129],
                              [16.770992, -3.232758],
                              [16.770975, -3.232722],
                              [16.774344, -3.229157],
                              [16.794601, -3.223943],
                              [16.806974, -3.228409],
                              [16.818311, -3.23337],
                              [16.820946, -3.234523],
                              [16.823474, -3.23563]]]]
          },
          "properties": {
            "centroid": {
              "type": "Point",
              "coordinates": [16.8545606240722, -3.33605202951116]
            },
            "cartodb_id": 1
          }
        }
      }
    end
    trait :geojson_no_props do
      geojson {
        {
          "type": "Feature",
          "geometry": {
            "type": "Polygon",
            "coordinates": [
              [
                [
                  18.03955078125,
                  51.11041991029264
                ],
                [
                  17.42431640625,
                  50.331436330838834
                ],
                [
                  17.99560546875,
                  49.79544988802771
                ],
                [
                  19.62158203125,
                  49.89463439573421
                ],
                [
                  20.0830078125,
                  50.42951794712287
                ],
                [
                  19.6875,
                  51.08282186160978
                ],
                [
                  18.91845703125,
                  51.31688050404585
                ],
                [
                  18.03955078125,
                  51.11041991029264
                ]
              ]
            ]
          }
        }
      }
    end
    factory :fmu_geojson, traits: [:geojson]
  end
end
